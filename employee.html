<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Civic Issue App</title>
<style>
  :root {
    --gov-blue:#0a3d62;
    --saffron:#ff9933;
    --danger:#d9534f;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    font-family:'Segoe UI',sans-serif;
    background:#f5f7fa;
    color:#333;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
  }

  .login-card, .dashboard, .feature{
    display:none;
    background:white;
    padding:2rem;
    border-radius:12px;
    box-shadow:0 4px 10px rgba(0,0,0,0.15);
    width:320px;
    text-align:center;
  }
  .active{display:block;}

  input,select,textarea,button{
    width:100%;padding:0.5rem;margin:0.5rem 0;border-radius:6px;border:1px solid #ccc;
  }
  button.primary{background:var(--gov-blue);color:white;border:none;font-weight:bold;cursor:pointer;}
  button.primary:hover{background:#074470;}
  button.back-btn{background:var(--danger);color:white;border:none;cursor:pointer;padding:0.5rem;}

  .dashboard-icons{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;}
  .dash-icon{
    background:#fff;
    border-radius:10px;
    padding:1rem;
    text-align:center;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
    cursor:pointer;
    transition:transform 0.2s;
  }
  .dash-icon:hover{transform:scale(1.05);}
  .dash-icon img{width:48px;height:48px;margin-bottom:0.5rem;}

  .menu-bar{display:flex;align-items:center;justify-content:space-between;}
  .menu-btn{font-size:24px;cursor:pointer;}
</style>
</head>
<body>

<!-- Employee Login (START PAGE) -->
<div class="login-card active" id="employeeLogin">
  <h2>Employee Login</h2>
  <input type="text" id="empId" placeholder="Employee ID"/>
  <input type="password" id="empPass" placeholder="Password"/>
  <button class="primary" onclick="empDepartmentStep()">Login</button>
</div>

<!-- Step 2: Department + ULB Login -->
<div class="login-card" id="departmentLogin">
  <h2>Departmental Login</h2>
  <select id="empULB">
    <option value="">Choose ULB</option>
  </select>
  <input type="text" id="deptId" placeholder="Departmental ID"/>
  <input type="password" id="deptPass" placeholder="Password"/>
  <button class="primary" onclick="deptLogin()">Login</button>
  <button class="back-btn" onclick="backToEmpLogin()">Back</button>
</div>

<!-- Employee Dashboard -->
<div class="dashboard" id="employeeDashboard">
  <div class="menu-bar">
    <span class="menu-btn" onclick="empMenu()">☰</span>
    <h2>Employee Dashboard</h2>
  </div>
  <div class="dashboard-icons">
    <div class="dash-icon" onclick="openFeature('assignedWorks')">
      <img src="https://img.icons8.com/ios-filled/100/0a3d62/task.png"/>
      <p>Assigned Works</p>
    </div>
    <div class="dash-icon" onclick="openFeature('updateIssue')">
      <img src="https://img.icons8.com/ios-filled/100/0a3d62/edit.png"/>
      <p>Update Issue</p>
    </div>
    <div class="dash-icon" onclick="openFeature('notifications')">
      <img src="https://img.icons8.com/ios-filled/100/0a3d62/appointment-reminders.png"/>
      <p>Notifications</p>
    </div>
  </div>
</div>

<!-- Features -->
<div class="feature" id="assignedWorks">
  <h2>Assigned Works</h2>
  <p>No works assigned yet.</p>
  <button class="back-btn" onclick="backToDash()">Back</button>
</div>

<div class="feature" id="updateIssue">
  <h2>Update Issue</h2>
  <textarea id="issueDesc" placeholder="Describe issue..."></textarea>
  <input type="file" id="issueFiles" accept="image/*,video/*,audio/*" multiple/>
  <input type="text" id="lat" placeholder="Latitude"/>
  <input type="text" id="lon" placeholder="Longitude"/>
  <input type="text" id="area" placeholder="Area"/>
  <input type="text" id="city" placeholder="City"/>
  <input type="text" id="state" placeholder="State"/>
  <input type="text" id="country" placeholder="Country"/>
  <input type="text" id="pincode" placeholder="Pincode"/>
  <button class="primary" onclick="submitUpdate()">Submit Update</button>
  <button class="back-btn" onclick="backToDash()">Back</button>
</div>

<div class="feature" id="notifications">
  <h2>Notifications</h2>
  <p>No new notifications.</p>
  <button class="back-btn" onclick="backToDash()">Back</button>
</div>

<div class="feature" id="menuOptions">
  <h2>Menu</h2>
  <button>Profile</button>
  <button onclick="logout()">Logout</button>
  <button class="back-btn" onclick="backToDash()">Back</button>
</div>

<script>
  const demoAccounts = {
    employee: { id: "EMP001", pass: "emp@123" },
    departments: {
      "Ranchi Municipal Corporation": { id: "MC-RAN-EMP-001", pass: "ran@123" },
      "Dhanbad Municipal Corporation": { id: "MC-DHN-EMP-002", pass: "dhn@123" },
      "Deoghar Municipal Corporation": { id: "MC-DEO-EMP-003", pass: "deo@123" },
      "Adityapur Municipal Corporation": { id: "MC-ADP-EMP-004", pass: "adp@123" },
      "Chas Municipal Corporation": { id: "MC-CHS-EMP-005", pass: "chs@123" }
    }
  };

  window.onload = function () {
    const ulbSelect = document.getElementById("empULB");
    Object.keys(demoAccounts.departments).forEach(ulb => {
      const opt = document.createElement("option");
      opt.value = ulb;
      opt.textContent = ulb;
      ulbSelect.appendChild(opt);
    });
  };

  function empDepartmentStep(){
    const id = document.getElementById("empId").value.trim();
    const pass = document.getElementById("empPass").value.trim();
    if(id === demoAccounts.employee.id && pass === demoAccounts.employee.pass){
      document.getElementById("employeeLogin").classList.remove('active');
      document.getElementById("departmentLogin").classList.add('active');
    } else {
      alert("❌ Invalid Employee credentials.\nTry ID: EMP001, Pass: emp@123");
    }
  }

  function deptLogin(){
    const ulb = document.getElementById("empULB").value.trim();
    const deptId = document.getElementById("deptId").value.trim();
    const deptPass = document.getElementById("deptPass").value.trim();
    const deptCreds = demoAccounts.departments[ulb];

    if(ulb && deptCreds && deptId === deptCreds.id && deptPass === deptCreds.pass){
      document.getElementById("departmentLogin").classList.remove('active');
      document.getElementById("employeeDashboard").classList.add('active');
    } else {
      alert(`❌ Invalid Departmental credentials.\nTry ID: ${deptCreds?.id}, Pass: ${deptCreds?.pass}`);
    }
  }

  function backToEmpLogin(){
    document.getElementById("departmentLogin").classList.remove('active');
    document.getElementById("employeeLogin").classList.add('active');
  }

  function backToDash(){
    document.querySelectorAll('.feature').forEach(f=>f.classList.remove('active'));
    document.getElementById("employeeDashboard").classList.add('active');
  }

  function openFeature(id){
    document.getElementById("employeeDashboard").classList.remove('active');
    document.querySelectorAll('.feature').forEach(f=>f.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    if(id === "updateIssue"){ detectLocation(); }
  }

  function empMenu(){ openFeature('menuOptions'); }

  function logout(){
    document.querySelectorAll('.dashboard, .feature').forEach(e=>e.classList.remove('active'));
    document.getElementById("employeeLogin").classList.add('active');
  }

  function detectLocation(){
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(pos=>{
        document.getElementById("lat").value = pos.coords.latitude;
        document.getElementById("lon").value = pos.coords.longitude;
      });
    }
  }

  function submitUpdate(){
    const issue = document.getElementById("issueDesc").value.trim();
    if(!issue){ alert("⚠️ Please describe the issue."); return; }
    alert("✅ Issue submitted successfully!");
    backToDash();
  }
</script>

</body>
</html>
